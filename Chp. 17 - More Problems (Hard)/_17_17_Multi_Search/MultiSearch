This problem requires knowledge of suffix trees.

First master Tries, then try this problem.
